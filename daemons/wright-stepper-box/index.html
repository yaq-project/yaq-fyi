<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" name="viewport" content="width=80ch">
  <title>wright-stepper-box</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>
<a href=../../>yaq</a>/<a href=../>daemons</a>/wright-stepper-box
</h1>

<hr>

Expose a stepper box motor as a yaq daemon.

The uses for this daemon combine the implementation of 'Filter Wheels' and 
'Linear stepper drivers' (sometimes referred to  as FuYu motors)

You can specify discrete stops which is particularly useful for discrete filter wheels.

The default settings are for operation as a continuous filter wheel:
- No discrete stops
- units of 'deg'
- 1.11111... steps per unit (0.9 degrees per step, or 400 steps per revolution)
- two full revolutions (720 degrees) in either direction from the home flag

The settings for our standard 50 mm 'fuyu' motors:
- No discrete stops
- units of 'mm'
- -100.0 steps per unit (pitch of 2.0 mm per revolution,  200 steps per revolution)
- Negative because of direction of travel from home
- limits = [0.0, 50.0]

The settings for our larger 400 mm 'fuyu' motors:
- No discrete stops
- units of 'mm'
- -20.0 steps per unit (pitch of 5.0 mm per revolution,  100 steps per revolution)
- Negative because of direction of travel from home
- limits = [0.0, 400.0]



<h2 id='external links'>external links<a href='#external links'> ¶</a></h2>
<p class="tab30">

  <a href=https://github.com/wright-group/yaqd-wright/issues>bugtracker</a> <br>

  <a href=https://github.com/wright-group/yaqd-wright>source</a> <br>




<h2 id='installation'>installation<a href='#installation'> ¶</a></h2>
<p>
  The wright-stepper-box daemon can be installed using the following package managers:
</p>
<p class="tab30">

  <a href=https://pypi.org/project/yaqd-wright>PyPI</a> <br>

  <a href=https://anaconda.org/conda-forge/yaqd-wright>conda-forge</a> <br>




<h2 id='traits'>traits<a href='#traits'> ¶</a></h2>
<p>
  The wright-stepper-box daemon is <a href="https://en.wikipedia.org/wiki/Composition_over_inheritance">composed</a> of the following traits:
</p>
<p class="tab30">

  <a href=../../traits/has-limits>has-limits</a>
  <br>

  <a href=../../traits/has-position>has-position</a>
  <br>

  <a href=../../traits/is-daemon>is-daemon</a>
  <br>

  <a href=../../traits/is-discrete>is-discrete</a>
  <br>

  <a href=../../traits/is-homeable>is-homeable</a>
  <br>

  <a href=../../traits/uses-serial>uses-serial</a>
  <br>

  <a href=../../traits/uses-uart>uses-uart</a>
  <br>

</p>





<h2 id='configuration'>configuration<a href='#configuration'> ¶</a></h2>

  
    <p class="tab30">
    <b>baud_rate</b> (int)
    <i>default: 57600</i>
    <br>
    
    
      <i>from <a href='../../traits/uses-uart'>uses-uart</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>enable</b> (boolean)
    <i>default: True</i>
    <br>
     Disable this daemon. The kind entry-point will not attempt to start this daemon. <br> 
    
      <i>from <a href='../../traits/is-daemon'>is-daemon</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>identifiers</b> ({'type': 'map', 'values': 'double'})
    <i>default: {}</i>
    <br>
     Position identifiers <br> 
    
      <i>from <a href='../../traits/is-discrete'>is-discrete</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>limits</b> (array)
    <i>default: [-720.0, 720.0]</i>
    <br>
     Configuration limits are strictly optional. <br> 
    
      <i>from <a href='../../traits/has-limits'>has-limits</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>log_level</b> ({'name': 'level', 'symbols': ['debug', 'info', 'notice', 'warning', 'error', 'critical', 'alert', 'emergency'], 'type': 'enum'})
    <i>default: info</i>
    <br>
     Set daemon log-level. <br> 
    
      <i>from <a href='../../traits/is-daemon'>is-daemon</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>log_to_file</b> (boolean)
    <i>default: False</i>
    <br>
     Optionally force logging to a file. <br> 
    
      <i>from <a href='../../traits/is-daemon'>is-daemon</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>make</b> (['null', 'string'])
    <i>default: None</i>
    <br>
    
    
      <i>from <a href='../../traits/is-daemon'>is-daemon</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>microstep</b> (int)
    <i>default: 1</i>
    <br>
     Increases angle resolution of motor stepping; valid integers are 1, 2, 4, 8, 16, 32; Must be the same for all motors in a box <br> 
    
    
    </p>
    

  
    <p class="tab30">
    <b>model</b> (['null', 'string'])
    <i>default: None</i>
    <br>
    
    
      <i>from <a href='../../traits/is-daemon'>is-daemon</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>motor</b> (int)
    <i>default: 0</i>
    <br>
     Index for the motor <br> 
    
    
    </p>
    

  
    <p class="tab30">
    <b>out_of_limits</b> (enum)
    <i>default: closest</i>
    <br>
     Control behavior of daemon when set_position is given a value outside of limits. <br> 
    
      <i>from <a href='../../traits/has-limits'>has-limits</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>port</b> (int)
    
    <br>
     TCP port for daemon to occupy. <br> 
    
      <i>from <a href='../../traits/is-daemon'>is-daemon</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>serial</b> (['null', 'string'])
    <i>default: None</i>
    <br>
     Serial number for the particular device represented by the daemon <br> 
    
      <i>from <a href='../../traits/is-daemon'>is-daemon</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>serial_port</b> (string)
    
    <br>
    
    
      <i>from <a href='../../traits/uses-uart'>uses-uart</a></i>
    
    
    </p>
    

  
    <p class="tab30">
    <b>steps_per_unit</b> (double)
    <i>default: 1.1111111111111112</i>
    <br>
     Number of full motor steps per 1 unit. This is independent of microstepping <br> 
    
    
    </p>
    

  
    <p class="tab30">
    <b>units</b> (string)
    <i>default: deg</i>
    <br>
     Units of the motor <br> 
    
    
    </p>
    




<h2 id='state'>state<a href='#state'> ¶</a></h2>
<p>
  The wright-stepper-box daemon will provide the following state information:
</p>

  
    <p class="tab30">
    <b>destination</b> (double) <br>
    
    
        <i>from <a href='../../traits/has-position'>has-position</a></i>
    
    </p>
    

  
    <p class="tab30">
    <b>hw_limits</b> (array) <br>
    
    
        <i>from <a href='../../traits/has-limits'>has-limits</a></i>
    
    </p>
    

  
    <p class="tab30">
    <b>position</b> (double) <br>
    
    
        <i>from <a href='../../traits/has-position'>has-position</a></i>
    
    </p>
    

  
    <p class="tab30">
    <b>position_identifier</b> (['null', 'string']) <br>
     Current position identifier. <br> 
    
        <i>from <a href='../../traits/is-discrete'>is-discrete</a></i>
    
    </p>
    




<h2 id='messages'>messages<a href='#messages'> ¶</a></h2>
<p>
  The wright-stepper-box daemon will expose the following public messages:
</p>

  
    <p class="tab30">
    <b>busy</b>
     ➜  boolean 
    <br>
     Returns true if daemon is currently busy. <br> 
    
    <i>from <a href='../../traits/is-daemon'>is-daemon</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>direct_serial_write</b>
     ➜  null 
    <br>
     Expose direct access to the serial port to clients.

This should not be encouraged for normal use, but may be very important for debugging.
If a device is expected to return data, it should be logged at the INFO level, not returned to the client.
This is done to allow long tasks to be run asynchronously, and to explicitly discourage use of this method except when debugging.
Setting `busy` to true is encouraged, but individual daemon writers should consider their own use case.
 <br> 
    
    <i>from <a href='../../traits/uses-serial'>uses-serial</a></i> <br>
    
    
    parameters: <br>
    </p>
    
    <p class="tab60">
        <b>message</b> (bytes)
        
        <br>
        
    </p>
    
    
    

  
    <p class="tab30">
    <b>get_config</b>
     ➜  string 
    <br>
     Full configuration for the individual daemon as defined in the TOML file.
This includes defaults and shared settings not directly specified in the daemon-specific TOML table.
 <br> 
    
    <i>from <a href='../../traits/is-daemon'>is-daemon</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_config_filepath</b>
     ➜  string 
    <br>
     String representing the absolute filepath of the configuration file on the host machine.
 <br> 
    
    <i>from <a href='../../traits/is-daemon'>is-daemon</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_destination</b>
     ➜  double 
    <br>
     Get current daemon destination. <br> 
    
    <i>from <a href='../../traits/has-position'>has-position</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_identifier</b>
     ➜  ['null', 'string'] 
    <br>
     Get current identifier string. Current identifier may be None. <br> 
    
    <i>from <a href='../../traits/is-discrete'>is-discrete</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_limits</b>
     ➜  {'items': 'double', 'type': 'array'} 
    <br>
     Get daemon limits.Limits will be the <a href='https://en.wikipedia.org/wiki/Intersection_(set_theory)'>intersection</a> of config limits and driver limits (when appliciable). <br> 
    
    <i>from <a href='../../traits/has-limits'>has-limits</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_position</b>
     ➜  double 
    <br>
     Get current daemon position. <br> 
    
    <i>from <a href='../../traits/has-position'>has-position</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_position_identifier_options</b>
     ➜  {'items': 'string', 'type': 'array'} 
    <br>
     Get position identifier names. Identifiers may not change at runtime. <br> 
    
    <i>from <a href='../../traits/is-discrete'>is-discrete</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_position_identifiers</b>
     ➜  {'type': 'map', 'values': 'double'} 
    <br>
     Get position identifiers. Identifiers may not change at runtime. <br> 
    
    <i>from <a href='../../traits/is-discrete'>is-discrete</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_state</b>
     ➜  string 
    <br>
     Get version of the running daemon <br> 
    
    <i>from <a href='../../traits/is-daemon'>is-daemon</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>get_units</b>
     ➜  ['null', 'string'] 
    <br>
     Get units of daemon. These units apply to the position and destination properties. <br> 
    
    <i>from <a href='../../traits/has-position'>has-position</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>home</b>
     ➜  null 
    <br>
     Initiates the homing procedure.
The daemon will report as busy during the homing procedure.
 After the homing procedure is complete, the daemon will return to the current destination.
 <br> 
    
    <i>from <a href='../../traits/is-homeable'>is-homeable</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>id</b>
     ➜  {'type': 'map', 'values': ['null', 'string']} 
    <br>
     JSON object with information to identify the daemon, including name, kind, make, model, serial.
 <br> 
    
    <i>from <a href='../../traits/is-daemon'>is-daemon</a></i> <br>
    
     </p>
    
    

  
    <p class="tab30">
    <b>in_limits</b>
     ➜  boolean 
    <br>
     Check if a given position is within daemon limits. <br> 
    
    <i>from <a href='../../traits/has-limits'>has-limits</a></i> <br>
    
    
    parameters: <br>
    </p>
    
    <p class="tab60">
        <b>position</b> (double)
        
        <br>
        
    </p>
    
    
    

  
    <p class="tab30">
    <b>set_identifier</b>
     ➜  double 
    <br>
     Set using an identifier. Returns new destination. <br> 
    
    <i>from <a href='../../traits/is-discrete'>is-discrete</a></i> <br>
    
    
    parameters: <br>
    </p>
    
    <p class="tab60">
        <b>identifier</b> (string)
        
        <br>
        
    </p>
    
    
    

  
    <p class="tab30">
    <b>set_position</b>
     ➜  null 
    <br>
     Give the daemon a new destination, and begin motion towards that destination. <br> 
    
    <i>from <a href='../../traits/has-position'>has-position</a></i> <br>
    
    
    parameters: <br>
    </p>
    
    <p class="tab60">
        <b>position</b> (double)
        
        <br>
        
    </p>
    
    
    

  
    <p class="tab30">
    <b>set_relative</b>
     ➜  double 
    <br>
     Give the daemon a new destination relative to its current position. Daemon will immediately begin motion towards new destination. Returns new destination. <br> 
    
    <i>from <a href='../../traits/has-position'>has-position</a></i> <br>
    
    
    parameters: <br>
    </p>
    
    <p class="tab60">
        <b>distance</b> (double)
        
        <br>
        
    </p>
    
    
    

  
    <p class="tab30">
    <b>shutdown</b>
     ➜  null 
    <br>
     Cleanly shutdown (or restart) daemon. <br> 
    
    <i>from <a href='../../traits/is-daemon'>is-daemon</a></i> <br>
    
    
    parameters: <br>
    </p>
    
    <p class="tab60">
        <b>restart</b> (boolean)
        <i>default: False</i>
        <br>
        
    </p>
    
    
    





<hr>

<p>
built 2022-10-19 03:05:06
                                    
<a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>: no copyright
</p>

</body>
</html>